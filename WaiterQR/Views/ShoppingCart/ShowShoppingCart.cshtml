@using WaiterQR.Models;
@{
    ViewBag.Title = "Shopping cart";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>ShowBasket</h2>


@{
    if (Session["ShoppingCartViewModel"] != null)
    {
        using (Html.BeginForm("UpdateCart", "ShoppingCart", FormMethod.Post))
        {

    <table class="table">
        <tr>
            <th>Name </th>
            <th>Price </th>
            <th>Quantity </th>
            <th>Sub Total </th>
        </tr>

        @foreach (var cart in (List<ShoppingCartViewModel>)Session["ShoppingCartViewModel"])
        {
    <tr>
        <td>@cart.product.ProductName</td>
        <td>@cart.product.ProductPrice</td>
        <td>
            <input type="text" name="quantity" id="quantity" value="@cart.quantity" />
            &nbsp;<span id="errmsg"></span>
        </td>
        <td>@(decimal.Parse(cart.product.ProductPrice) * cart.quantity)</td>
        <td>
            @Html.ActionLink("Delete", "Delete", "ShoppingCart", new { id = cart.product.ProductID }, new { onclick = "return cornfirm('Are you sure you want to delete this?');" })

        </td>
    </tr>
        }
        <tr>
            <td colspan="3">Total:</td>
            <td>
                @{
                    List<ShoppingCartViewModel> temp = (List<ShoppingCartViewModel>)Session["ShoppingCartViewModel"];
                    var total = String.Format("{0:N0}", temp.Sum(x => Convert.ToDecimal(x.quantity) * decimal.Parse(x.product.ProductPrice)));
                }
                @total €
            </td>
        </tr>

       
    </table>
<br />

<div>
    <button class="btn btn-secondary">
        @Html.ActionLink("Order Now", "OrderFinished", "ShoppingCart")
    </button>
</div>

@Html.ActionLink("Continue Shopping?", "ShowMenu", "Menu", new { tableid = Session["tableid"] }, null)
        <br/>
        <input type="submit" value="Update Cart"/>
        }
    }
    else
    {
       <h4> No items in your cart!!</h4>
    } 
}
<script type="text/javascript">
    $(document).ready(function(){
        $("#quantity").keypress(function (e){
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                $("#errmsg").html("Enter digits only!").show().fadeOut("slow");
                return false;
            }
        });
    });
</script>